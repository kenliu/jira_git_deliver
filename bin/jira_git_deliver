#!/usr/bin/env ruby

require 'dotenv'
require 'jira_git_deliver'

Dotenv.load # only used during development/test

#TODO validate all environment variables

jira = JiraGitDeliver::Jira.new(
  oauth_access_token: ENV['OAUTH_ACCESS_TOKEN'],
  oauth_secret: ENV['OAUTH_SECRET'],
  consumer_key: ENV['CONSUMER_KEY'],
  site: ENV['SITE']
)
git = JiraGitDeliver::Git.new
deliverer = JiraGitDeliver::Deliverer.new(jira, git)

deliverer.deliver(ENV['FINISHED_ISSUES_JQL'], ENV['DELIVERED_STATUS'])
